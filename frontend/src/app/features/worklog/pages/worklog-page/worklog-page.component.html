<section class="worklog-page" *ngIf="state$ | async as state">
  <header class="page-header">
    <div>
      <p class="eyebrow">Team Productivity Console</p>
      <h1>Worklog</h1>
    </div>
    <div class="header-actions">
      <div class="user-box">
        <label for="employeeSelect">Welcome</label>
        <select
          id="employeeSelect"
          [value]="state.selectedEmployeeId ?? ''"
          (change)="onEmployeeChange($any($event.target).value)"
        >
          <option value="" disabled>Select employee...</option>
          <option *ngFor="let employee of state.employees" [value]="employee.id">
            {{ employee.name }}
          </option>
        </select>
      </div>

      <button class="save-button" type="button" (click)="onSaveDay()" [disabled]="state.loading || !state.selectedEmployeeId">
        Save Day
      </button>
    </div>
  </header>

  <div class="grid">
    <article class="panel">
      <h2>New Activity</h2>
      <app-activity-form
        [lookups]="state.lookups"
        [loading]="state.loading || !state.selectedEmployeeId"
        (startActivity)="onStartActivity($event)"
      />
      <p class="status info" *ngIf="!state.selectedEmployeeId">
        Select an employee to start tracking activities.
      </p>
    </article>

    <article class="panel">
      <h2>Timer / Summary</h2>
      <app-running-timer
        [startedAt]="state.currentEntry?.startedAt ?? null"
        [currentEntry]="state.currentEntry"
      />
      <app-day-summary [entries]="state.entries" />
    </article>

    <article class="panel">
      <h2>Activity History</h2>
      <app-activity-table [entries]="state.entries" />
    </article>
  </div>

  <p class="status" *ngIf="state.loading">Loading data...</p>
  <p class="status info" *ngIf="showNoWorkdayMessage(state)">
    No workday for employee: {{ selectedEmployeeName(state) }}
  </p>
  <p class="status error" *ngIf="state.error">{{ state.error }}</p>
</section>
